clc; clear all; close all;

syms t real

%alpha__, beta_, gamma_ and delta_ time functions
syms alpha_(t) beta_(t) gamma_(t) delta_(t)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Set up measurements (symbolic in part 1)
% Constants
syms g                                                      % gravity [ms^-2]
% Frame Measurements
syms L                                                      % Distance from O to G [m]
syms h_rod                                                  % Height of vertical rod [m]
syms R_min_H_tor                                            % Horizontal torus minor radius [m]
syms R_maj_H_tor                                            % Horizontal torus marjor radius[m]
syms R_min_V_tor                                            % Vertical torus minor radius [m]
syms R_maj_V_tor                                            % Vertical torus major radius [m]

% Rotor measurements
syms m_frame                                                % Mass of frame [kg] (Measured)
syms m_rotor                                                % Mass of rotor [kg] (Measured)
syms H_rot                                                  % Rotor rod height [m]
syms r_rot                                                  % Rotor rod radius [m] (Vertical rod)
syms R_min_rotor                                            % Minor radius of rotor torus [m]
syms R_maj_rotor                                            % Major radius of rotor torus [m]

% Top and bottom spheres (For animation only, DO NOT MODEL THEM AS A PART OF THE FRAME)
syms R_sph       

%Symbolic variables for reaction Forces and Moments
syms F_Ox F_Oy F_Oz real
syms F_Gx F_Gy F_Gz real
syms M_Gx M_Gy M_Gz real
syms M_Ox M_Oy M_Oz real

% reaction forces
% Reaction force to the rotor at Point G
Frotor_4 = [F_Gx; F_Gy; F_Gz];
% Reaction moment to the rotor
Mrotor_4 = [M_Gx; M_Gy; M_Gz]; % M_Gz==0 is eom.
% Reaction force to the frame at Point O
Fframe_3 = [F_Ox; F_Oy; F_Oz];
% Reaction moment to the frame
Mframe_3 = [M_Ox; M_Oy; M_Oz]; % all three are eoms

%zero equations for the reaction forces/moments that don't exist
% variable name: zero_reaction
zero_reaction = ([M_Gz;M_Ox;M_Oy;M_Oz]==0);

syms al be ga de 
syms al_d be_d ga_d de_d
syms al_dd be_dd ga_dd de_dd
%frame 4 (Frame on rotor)
F_Gx = simplify((2*R_maj_rotor*R_min_rotor^2*g*m_rotor*pi^2*sin(beta_(t))*(cos(delta_(t))*sin(gamma_(t)) + cos(gamma_(t))*sin(delta_(t))))/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(L*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*diff(delta_(t), t) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*diff(delta_(t), t)) - L*(cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)))*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t)))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)); 
F_Gy = simplify((R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(L*(- cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*diff(delta_(t), t) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*diff(delta_(t), t)) - L*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)))*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t)))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) + (2*R_maj_rotor*R_min_rotor^2*g*m_rotor*pi^2*sin(beta_(t))*(cos(delta_(t))*cos(gamma_(t)) - sin(delta_(t))*sin(gamma_(t))))/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)); 
F_Gz = simplify((2*R_maj_rotor*R_min_rotor^2*g*m_rotor*pi^2*cos(beta_(t)))/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(L*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)))^2 + L*(cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)))^2)*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2));

%Frame 3 (Stand on Frame forces)
F_Ox = simplify(F_Gx*cos(delta_(t)) - (L*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) - L*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t)))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)) - F_Gy*sin(delta_(t)) + g*sin(beta_(t))*sin(gamma_(t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))); 
F_Oy = simplify(F_Gy*cos(delta_(t)) - (L*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + L*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t)))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)) + F_Gx*sin(delta_(t)) + g*cos(gamma_(t))*sin(beta_(t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))); 
F_Oz = simplify(F_Gz - (L*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))^2 + L*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))^2)*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)) + g*cos(beta_(t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2)/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) + (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)));

% Frame 4. (moments on rotor from G. M_Gz is free one = 0
M_Gx = simplify((R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)))*(R_maj_rotor^2/2 + (5*R_min_rotor^2)/8)*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(R_maj_rotor^2 + (3*R_min_rotor^2)/4)*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)))*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(R_maj_rotor^2/2 + (5*R_min_rotor^2)/8)*(- cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*diff(delta_(t), t) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*diff(delta_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)); 
M_Gy = simplify((R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)))*(R_maj_rotor^2/2 + (5*R_min_rotor^2)/8)*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(R_maj_rotor^2 + (3*R_min_rotor^2)/4)*(cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t)) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t)))*(cos(beta_(t))*diff(alpha_(t), t) + diff(delta_(t), t) + diff(gamma_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2) - (R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(R_maj_rotor^2/2 + (5*R_min_rotor^2)/8)*(cos(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + sin(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + cos(delta_(t))*(cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*diff(delta_(t), t) - sin(delta_(t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*diff(delta_(t), t))*2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)); 
M_Gz = simplify((2*R_maj_rotor*R_min_rotor^2*m_rotor*pi^2*(R_maj_rotor^2 + (3*R_min_rotor^2)/4)*(cos(beta_(t))*diff(alpha_(t), t, 2) - sin(beta_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + diff(delta_(t), t, 2) + diff(gamma_(t), t, 2)))/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2));

%Frame 3 (stand on frame) - all ==0.
M_Ox = simplify(((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2))*(cos(gamma_(t))*diff(beta_(t), t, 2) - sin(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t, 2) + cos(beta_(t))*sin(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + cos(gamma_(t))*sin(beta_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + M_Gx*cos(delta_(t)) - F_Oy*L - M_Gy*sin(delta_(t)) + (sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t))*((2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2 + (3*R_min_V_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2)) - (sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2 + (3*R_min_H_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (r_rot^2*((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)))/2 + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2))); 
M_Oy = simplify(M_Gy*cos(delta_(t)) - ((2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2 + (3*R_min_V_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2))*(sin(gamma_(t))*diff(beta_(t), t, 2) + cos(gamma_(t))*diff(gamma_(t), t)*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t, 2) - cos(beta_(t))*cos(gamma_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(gamma_(t), t)*diff(alpha_(t), t)) + F_Ox*L + M_Gx*sin(delta_(t)) - (cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2 + (3*R_min_H_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (r_rot^2*((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)))/2 + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2)) + (cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*(cos(beta_(t))*diff(alpha_(t), t) + diff(gamma_(t), t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2))); 
M_Oz = simplify(M_Gz + (cos(beta_(t))*diff(alpha_(t), t, 2) - sin(beta_(t))*diff(beta_(t), t)*diff(alpha_(t), t) + diff(gamma_(t), t, 2))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2 + (3*R_min_H_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (r_rot^2*((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2)))/2 + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2)) - (cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*((2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2 + (3*R_min_V_tor^2)/4))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2)) + (cos(gamma_(t))*diff(beta_(t), t) + sin(beta_(t))*sin(gamma_(t))*diff(alpha_(t), t))*(sin(gamma_(t))*diff(beta_(t), t) - cos(gamma_(t))*sin(beta_(t))*diff(alpha_(t), t))*((2*R_maj_H_tor*R_min_H_tor^2*m_frame*pi^2*(R_maj_H_tor^2/2 + (5*R_min_H_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - ((pi*m_frame*r_rot^2*(H_rot - h_rod))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2) - (pi*H_rot*m_rotor*r_rot^2)/(2*R_maj_rotor*pi^2*R_min_rotor^2 + H_rot*pi*r_rot^2))*(h_rod^2/12 + r_rot^2/4) + (2*R_maj_V_tor*R_min_V_tor^2*m_frame*pi^2*(R_maj_V_tor^2/2 + (5*R_min_V_tor^2)/8))/(2*R_maj_H_tor*pi^2*R_min_H_tor^2 + 2*R_maj_V_tor*pi^2*R_min_V_tor^2 - pi*(H_rot - h_rod)*r_rot^2)));

M_Gz = subs(M_Gz, [alpha_, beta_, gamma_, delta_,  diff(alpha_,t), diff(beta_,t), diff(gamma_, t), diff(delta_,t), diff(alpha_,t, t), diff(beta_,t, t), diff(gamma_, t, t), diff(delta_,t, t) ], ...
    [al, be, ga, de, al_d, be_d, ga_d, de_d, al_dd, be_dd, ga_dd, de_dd]);
M_Ox = subs(M_Ox, [alpha_, beta_, gamma_, delta_,  diff(alpha_,t), diff(beta_,t), diff(gamma_, t), diff(delta_,t), diff(alpha_,t, t), diff(beta_,t, t), diff(gamma_, t, t), diff(delta_,t, t) ], ...
    [al, be, ga, de, al_d, be_d, ga_d, de_d, al_dd, be_dd, ga_dd, de_dd]);
M_Oy = subs(M_Oy, [alpha_, beta_, gamma_, delta_,  diff(alpha_,t), diff(beta_,t), diff(gamma_, t), diff(delta_,t), diff(alpha_,t, t), diff(beta_,t, t), diff(gamma_, t, t), diff(delta_,t, t) ], ...
    [al, be, ga, de, al_d, be_d, ga_d, de_d, al_dd, be_dd, ga_dd, de_dd]);
M_Oz = subs(M_Oz, [alpha_, beta_, gamma_, delta_,  diff(alpha_,t), diff(beta_,t), diff(gamma_, t), diff(delta_,t), diff(alpha_,t, t), diff(beta_,t, t), diff(gamma_, t, t), diff(delta_,t, t) ], ...
    [al, be, ga, de, al_d, be_d, ga_d, de_d, al_dd, be_dd, ga_dd, de_dd]);

% equations = [
%     simplify(M_Gz)==0
%     simplify(M_Ox)==0
%     simplify(M_Oy)==0
%     simplify(M_Oz)==0
% ];

equations = [
    %M_Gz
    0==(2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_dd + ga_dd + al_dd*cos(be) - al_d*be_d*sin(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2); 
    %M_Ox
    0==sin(de)*((2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_dd*sin(ga) - al_dd*cos(ga)*sin(be) + be_d*ga_d*cos(ga) - al_d*be_d*cos(be)*cos(ga) + al_d*ga_d*sin(be)*sin(ga)) + sin(de)*(be_dd*cos(ga) - be_d*ga_d*sin(ga) + al_dd*sin(be)*sin(ga) + al_d*be_d*cos(be)*sin(ga) + al_d*ga_d*cos(ga)*sin(be)) + de_d*cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - de_d*sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be))))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) - (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)))*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) + (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)))*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2)) - cos(de)*((2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(sin(de)*(be_dd*sin(ga) - al_dd*cos(ga)*sin(be) + be_d*ga_d*cos(ga) - al_d*be_d*cos(be)*cos(ga) + al_d*ga_d*sin(be)*sin(ga)) - cos(de)*(be_dd*cos(ga) - be_d*ga_d*sin(ga) + al_dd*sin(be)*sin(ga) + al_d*be_d*cos(be)*sin(ga) + al_d*ga_d*cos(ga)*sin(be)) + de_d*cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + de_d*sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga))))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) - (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)))*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) + (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)))*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2)) + ((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)))*(be_dd*cos(ga) - be_d*ga_d*sin(ga) + al_dd*sin(be)*sin(ga) + al_d*be_d*cos(be)*sin(ga) + al_d*ga_d*cos(ga)*sin(be)) + L*(m_frame + m_rotor)*(- L*cos(be)*cos(ga)*sin(be)*al_d^2 + 2*L*be_d*cos(be)*sin(ga)*al_d - g*cos(ga)*sin(be) + L*be_dd*cos(ga) + L*al_dd*sin(be)*sin(ga)) - (ga_d + al_d*cos(be))*(be_d*sin(ga) - al_d*cos(ga)*sin(be))*(0.5000*r_rot^2*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(R_maj_H_tor^2 + 0.7500*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (ga_d + al_d*cos(be))*(be_d*sin(ga) - al_d*cos(ga)*sin(be))*((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(R_maj_V_tor^2 + 0.7500*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)))
    %M_Oy
    0==L*(m_frame + m_rotor)*(L*cos(be)*sin(be)*sin(ga)*al_d^2 + 2*L*be_d*cos(be)*cos(ga)*al_d + g*sin(be)*sin(ga) - L*be_dd*sin(ga) + L*al_dd*cos(ga)*sin(be)) - cos(de)*((2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_dd*sin(ga) - al_dd*cos(ga)*sin(be) + be_d*ga_d*cos(ga) - al_d*be_d*cos(be)*cos(ga) + al_d*ga_d*sin(be)*sin(ga)) + sin(de)*(be_dd*cos(ga) - be_d*ga_d*sin(ga) + al_dd*sin(be)*sin(ga) + al_d*be_d*cos(be)*sin(ga) + al_d*ga_d*cos(ga)*sin(be)) + de_d*cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - de_d*sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be))))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) - (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)))*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) + (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(cos(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)) - sin(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)))*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2)) - sin(de)*((2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(sin(de)*(be_dd*sin(ga) - al_dd*cos(ga)*sin(be) + be_d*ga_d*cos(ga) - al_d*be_d*cos(be)*cos(ga) + al_d*ga_d*sin(be)*sin(ga)) - cos(de)*(be_dd*cos(ga) - be_d*ga_d*sin(ga) + al_dd*sin(be)*sin(ga) + al_d*be_d*cos(be)*sin(ga) + al_d*ga_d*cos(ga)*sin(be)) + de_d*cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + de_d*sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga))))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) - (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(0.5000*R_maj_rotor^2 + 0.6250*R_min_rotor^2)*(cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)))*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2) + (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(cos(de)*(be_d*sin(ga) - al_d*cos(ga)*sin(be)) + sin(de)*(be_d*cos(ga) + al_d*sin(be)*sin(ga)))*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_d + ga_d + al_d*cos(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2)) - ((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(R_maj_V_tor^2 + 0.7500*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)))*(be_dd*sin(ga) - al_dd*cos(ga)*sin(be) + be_d*ga_d*cos(ga) - al_d*be_d*cos(be)*cos(ga) + al_d*ga_d*sin(be)*sin(ga)) + (ga_d + al_d*cos(be))*(be_d*cos(ga) + al_d*sin(be)*sin(ga))*((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) - (ga_d + al_d*cos(be))*(be_d*cos(ga) + al_d*sin(be)*sin(ga))*(0.5000*r_rot^2*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(R_maj_H_tor^2 + 0.7500*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)))
    %M_Oz
    0==(ga_dd + al_dd*cos(be) - al_d*be_d*sin(be))*(0.5000*r_rot^2*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(R_maj_H_tor^2 + 0.7500*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (be_d*cos(ga) + al_d*sin(be)*sin(ga))*(be_d*sin(ga) - al_d*cos(ga)*sin(be))*((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(0.5000*R_maj_V_tor^2 + 0.6250*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) - (be_d*cos(ga) + al_d*sin(be)*sin(ga))*(be_d*sin(ga) - al_d*cos(ga)*sin(be))*((0.0833*h_rod^2 + 0.2500*r_rot^2)*((3.1416*H_rot*m_rotor*r_rot^2)/(19.7392*R_maj_rotor*R_min_rotor^2 + 3.1416*H_rot*r_rot^2) - (3.1416*m_frame*r_rot^2*(H_rot - h_rod))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (19.7392*R_maj_H_tor*R_min_H_tor^2*m_frame*(0.5000*R_maj_H_tor^2 + 0.6250*R_min_H_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod)) + (19.7392*R_maj_V_tor*R_min_V_tor^2*m_frame*(R_maj_V_tor^2 + 0.7500*R_min_V_tor^2))/(19.7392*R_maj_H_tor*R_min_H_tor^2 + 19.7392*R_maj_V_tor*R_min_V_tor^2 - 3.1416*r_rot^2*(H_rot - h_rod))) + (2.7780e+15*R_maj_rotor*R_min_rotor^2*m_rotor*(R_maj_rotor^2 + 0.7500*R_min_rotor^2)*(de_dd + ga_dd + al_dd*cos(be) - al_d*be_d*sin(be)))/(2.7780e+15*R_maj_rotor*R_min_rotor^2 + 4.4214e+14*H_rot*r_rot^2)
];



%[A,b] = equationsToMatrix(equations, [al_dd, be_dd, ga_dd, de_dd]);
%X = A\b;
